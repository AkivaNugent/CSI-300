use employees;

-- -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

select e.eid, e.efn, e.eln, ep.pos_id, pos_name, salary, sal_value, (salary - sal_value) as 'Difference', sal_date

from employee as e
join EmpHistory as eh on e.eid = eh.eid
join EmpPos as ep on eh.pos_id = ep.pos_id
join SalPos as sp on ep.pos_id = sp.pos_id

where sal_id=2 
  and sal_date = '2023-10-31' 
  and (salary - sal_value) > 0;

-- ------------------------------------------
/*
select e.eid, e.efn, e.eln, eh.pos_id, salary

from employee as e
join EmpHistory as eh on e.eid = eh.eid

where eh.pos_id = 1;
*/
-- ------------------------------------------

/*
select * from EmpHistory

where pos_id = 1
*/
-- ------------------------------------------
-- ------------------------------------------
-- ------------------------------------------
-- ------------------------------------------
-- ------------------------------------------
-- ------------------------------------------
-- ------------------------------------------
-- ------------------------------------------
-- ------------------------------------------
-- ------------------------------------------
-- ------------------------------------------
-- ------------------------------------------
-- ------------------------------------------
-- ------------------------------------------
-- ------------------------------------------
-- ------------------------------------------
-- ------------------------------------------
-- ------------------------------------------
-- ------------------------------------------
-- ------------------------------------------